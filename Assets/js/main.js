var DEVMODE=!1,STATIC_URI_PREFIX="";"undefined"==typeof DEVMODE&&(window.DEVMODE=!0),"undefined"==typeof STATIC_URI_PREFIX&&(window.STATIC_URI_PREFIX="/"),"undefined"==typeof BUILD_TS&&(window.BUILD_TS=Number(new Date)),function(t){function e(){if(DEVMODE){if(!v)return;var t=g.debug||g.log;t.apply(g,arguments)}}function n(t){this.state="pending",this._cbs=[],void 0!==t&&this.resolve(t)}function r(t,e,r){"function"==typeof e&&(r=e,e=[]),"function"==typeof r&&(t in m||(w[t]=w[t]||new n,o(t,e,r,function(){var e=m[t]=i(t,r);h(t,e),a(t)})))}function i(t,e){function n(e){return c(t,e)}if(!DEVMODE)return e(n);try{return e(n)}catch(r){_=!0;var i="Error loading module: "+t+" "+r;throw l(i),g.error(i,r),i}}function o(t,n,r,i){if(DEVMODE&&e("LOADING DEPS FOR",t),!DEVMODE)return i();var o=String(r);return o.replace(b,function(e,r){n.push(p(t,r))}),n.length?void s(n,i):i()}function s(t,e){for(var r=[],i=0;i<t.length;i++)r.push(u(t[i]));n.all(r).done(e)}function u(t){if(DEVMODE&&e("%c DEP LOAD "+t,"color:gray;"),t in w){var r=w[t];return DEVMODE&&e("%c PENDING FOUND:"+t+", State: "+r.state,"color:purple"),r}if(DEVMODE){e("%c LOADING FROM REMOTE "+t,"color:red");var i=w[t]=new n,o=document,s=o.createElement("script");if(s.type="text/javascript",s.src=x+t+".js",s.async=!0,s.onerror=function(){throw"Error loading script '"+s.src+"'."},o.head)o.head.appendChild(s);else{var u=o.body.firstChild;o.body.insertBefore(s,u)}return setTimeout(function(){"pending"!==i.state||_||(g.error("%c Failed loading script "+t,"color:red;"),l("Failed loading script: "+t))},y),i}}function a(t){t in w?w[t].resolve(t):w[t]=new n(t),DEVMODE&&e("%c RESOLVED "+t,"color:green")}function l(t){if(DEVMODE){var e=document.body,n=e.firstChild,r=document.createElement("div");r.setAttribute("style","background:#a10;color:#fff;font-size:12px;border-bottom:1px solid #fff;text-align:center;padding:7px;width:100%;height:20px;z-index:100;position:relative"),r.innerHTML=t,e.insertBefore(r,n)}}function c(t,e){if(e=p(t,e),!(e in m))throw"Module "+e+" is not loaded :(";return m[e]}function p(t,e){if(e.indexOf("./")>-1){var n=t.substr(0,t.lastIndexOf("/"));return n+e.substr(1)}return e}function f(e,n){if("string"==typeof e&&(e=[e]),"function"!=typeof n)throw"You must specify a callback function";s(e,function(){for(var r=[],i=0;i<e.length;i++)r.push(c("",e[i]));n.apply(t,r)})}function d(t,e){if(t in m)throw t+" is already defined!";m[t]=e}function h(e,n){if("jquery"!==e)for(var r,i=e.split("/"),o=t;i.length&&(r=i.shift());)o[r]?o=o[r]:i.length?o=o[r]={}:o[r]=n}var v=!1,y=2e4,g=window.console||{debug:function(){},log:function(){},error:function(){}};n.prototype={done:function(t){"completed"===this.state?t(this.result):this._cbs.push(t)},resolve:function(t){this.result=t,this.state="completed";for(var e=0;e<this._cbs.length;e++)this._cbs[e](t)}},n.all=function(t){function e(){i-=1,i||r.resolve()}var r=new n,i=t.length;if(!i)return r.resolve(),r;for(var o=0;o<t.length;o++){var s=t[o];s.done(e)}return r};var m={},w={},_=!1,b=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,x="/js/";t.define=r,t.require=f,t.legacyDefine=d}(window),define("fire/ui/overlay",function(t){function e(t,e,u){n(),t=t||o;var a=$.Deferred(),p=$("<div/>").addClass(s+" "+(e||""));return i=p.css({position:"absolute","z-index":t,top:0,left:0,overflow:"hidden"}),c.on("resize",r),r(),l.prepend(p),p.click(function(t){a.resolve(t),u&&n()}),a.promise()}function n(t){return i?(c.off("resize",r),t&&i.animate({opacity:0},u),$.when(i).done(function(){i&&i.remove(),i=null})):void 0}function r(){i&&(i.hide(),i.css({width:l[0].scrollWidth,height:l[0].scrollHeight}),i.show())}var i,o=5e3,s="fire-shim",u=300,a=$(document),l=$(a[0].body),c=$(window);return{show:e,remove:n}}),define("fire/util/mobile",function(t){var e,n,r,i,o,s,u,a;return a=function(t){var e,n;return(n=window.matchMedia||window.msMatchMedia)?(e=n(t),e&&(e.matches||!1)):!1},r=function(){return i()||u()},e=function(){return a("(orientation: landscape)")},o=function(){return a("(orientation: portrait)")},i=function(){return a("only screen and (min-device-width: 320px) and (max-device-width: 480px)")},u=function(){return a("only screen and (min-device-width:768px) and (max-device-width:1024px)")},s=function(){return a("only screen and (-webkit-min-device-pixel-ratio : 1.5)")||a("only screen and (min-device-pixel-ratio : 1.5)")},n=function(){return a("only screen and (max-width: 720px)")},{mq:a,isMobile:r,isLandscape:e,isPortrait:o,isPhone:i,isTablet:u,isRetina:s,isMiniLayout:n}}),define("fire/ui/modal",function(t){function e(t,e){return n($.get(t),e)}function n(t,e){var n=$.Deferred();return"resolved"===t.state()?(t.done(function(t){return o(t,e).done(n.resolve),n.promise()}),n.promise()):(o(r(e),e).done(function(){t.done(function(t){_.html(t),s(),n.resolve(m)}).fail(function(t){_.html(i()),m.addClass(O+"-error"),s(),n.reject(m)})}),n.promise())}function o(t,e){var n=$.Deferred();if(w=$.extend({},k,e,{}),l(),I)return p(t);var r=e.containerEl||T;if(m=u(t,O,r),e.containerEl&&m.data("containerEl",e.containerEl),m.css("width",e.width),!e.skipOverlay){var i=E;e.overlayClass&&(i+=" "+e.overlayClass);var o=S.show(w.zIndex,i,w.overlayClose);w.overlayClose&&o.done(l)}return s(),e.resolveBeforeAnimation&&n.resolve(m),w.animate&&a("show",m),$.when(m).done(n.resolve),n.promise()}function s(){if(m&&!I){var t=m.width(),e=m.height(),n=0,r=0;if(m.data("containerEl")){var i=m.data("containerEl"),o=i.height(),s=i.width();r=o/2-e/2,0>r&&(r=50),n=s/2-t/2}else{var u=M.scrollTop(),a=M.scrollLeft(),l=window.innerWidth||M.width(),c=window.innerHeight||M.height();r=u+c/2-e/2,u>r&&(r=u+50),n=a+l/2-t/2}m.css({top:r,left:n}),window.setTimeout(h,20)}}function u(t,e,n){var r=$(t).show(),i=$("<div/>").addClass(e+"  "+(w.cssClass||""));return _=r.wrap("<div/>").parent().addClass(O+"-content"),i.append(_),n.append(i),i.delegate("."+O+"-close","click",g),i}function a(t,e){return e?(e.addClass("no-shadow"),"show"===t&&e.css({"margin-top":"-50px",opacity:0}).show().animate({"margin-top":0,opacity:1},F),"hide"===t&&e.animate({"margin-top":"50px",opacity:0},F),$.when(e).done(function(){e.removeClass("no-shadow")})):$.when()}function l(t){if(!m)return $.when();if(I)return c();y();var e=m;M.off("resize",s);var n=S.remove(!t&&w.animate);return w.animate&&!t&&a("hide",e),$.when(n,e).done(function(){$("div.tipsy").hide(),w&&w.close&&w.close(e),e.detach();var t=m.data("containerEl");_=m=w=e=null,t&&t.remove()})}function c(){var t=m;return w&&w.close&&w.close(t),t.remove(),_=m=w=t=null,f(),T.removeClass("mobile-modal-body"),A&&(T.scrollTop(A),A=null),$.when()}function p(t){return A=T.scrollTop(),d(),m=u(t,P,T),T.addClass("mobile-modal-body"),T.scrollTop(0),$.when(m)}function f(){x.show(),x=null}function d(){x=T.children(":visible").hide()}function h(){var t=$.fn.placeholderPolyfill;m&&t&&t(m,!0)}function v(){b=!0,m&&m.addClass("fire-modal-locked")}function y(){b=!1,m&&m.removeClass("fire-modal-locked")}function g(t){t.preventDefault(),t.stopImmediatePropagation();var e=$(t.currentTarget);b||e.hasClass("disabled")||l()}var m,w,_,b,x,S=t("fire/ui/overlay"),C=t("fire/util/mobile"),V=101,k={animate:!0,width:500,overlayClose:!0,loadingTitle:"Loading...",overlayClass:"",close:null,cssClass:"",loadingSubtitle:"",zIndex:V,skipOverlay:!1,containerEl:!1},E="fire-modal-overlay",O="fire-modal",P="fire-modal-mobile",F=250,M=$(window),T=$("body"),D="ontouchend"in document,I=C.isPhone(),A=null;D||M.on("resize",s);var B={close:l,show:o,showUrl:e,showDeferred:n,position:s,lock:v,unlock:y};return window.fire.modal=B,window.fire.modal.reposition=s,B}),define("fire/util/eventEmitter",function(t){var e;return e=function(){function t(){this.__ev={}}var e,n;return e=0,n=function(){return e+=1,"ev_"+e},t.prototype.on=function(t,e){return!e||(t in this.__ev||(this.__ev[t]=[]),this.__findCallbackIdx(t,e)>0)?void 0:(e.guid||(e.guid=n()),this.__ev[t].push(e),this)},t.prototype.one=function(t,e){var r,i;return i=this,r=function(){return e.apply(this,arguments),i.off(t,e)},e.guid||(e.guid=n()),r.guid=e.guid,this.on(t,r)},t.prototype.off=function(t,e){var n;return e?(n=this.__findCallbackIdx(t,e),n>-1&&this.__ev[t].splice(n,1),this):void delete this.__ev[t]},t.prototype.trigger=function(t){var e,n,r,i;if(t in this.__ev){for(i=this.__ev[t],n=0,r=i.length;r>n;n++)e=i[n],e.apply(this,Array.prototype.slice.call(arguments,1));return this}},t.prototype.__findCallbackIdx=function(t,e){var n,r,i,o,s;if(!(t in this.__ev))return-1;for(s=this.__ev[t],i=r=0,o=s.length;o>r;i=++r){if(n=s[i],n===e)return i;if(n.guid&&n.guid===e.guid)return i}return-1},t}(),{Emitter:e}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty,slice=[].slice;define("fire/ui/view",function(t){var e,n;return n=t("fire/util/eventEmitter"),e=function(t){function e(t){null==t&&(t={}),this.options=t,this.defaultOptions&&(this.options=$.extend({},this.defaultOptions,t)),e.__super__.constructor.apply(this,arguments),this._modifiers={},this.el=t.el,this.el?this.options=$.extend({},this.defaultOptions,this.el.data(),t):this.el=this.generate(),this.autoRender&&(this.render(),this.setup())}return extend(e,t),e.prototype.autoRender=!0,e.prototype.render=function(){return null},e.prototype.setup=function(){return this.attrs&&this.el.attr(this.attrs),this.cssClass&&this.el.addClass(this.cssClass),this.events?this.delegate(this._extractEvents(this.events)):void 0},e.prototype.remove=function(){return this.beforeRemove&&this.beforeRemove(),this.el&&this.el.remove(),this.removed=!0},e.prototype.find=function(t){return this.el.find(t)},e.prototype.delegate=function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(this.el.on(e.name,e.selector,e.handler));return i},e.prototype.undelegate=function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(this.el.off(e.name,e.selector,e.handler));return i},e.prototype.generate=function(){var t,e,n,r;if(this.templateSelector){if(r=_.result(this,"templateSelector"),n=$(r),e=n.html(),t=n.data("class")||"",!e)throw"Could not find html content with the selector "+r+".";return $("<div>").addClass(t).append(e)}},e.prototype._extractEvents=function(t){var e,n,r;return t?(e=function(t){return function(e,n){var r,i,o,s;if(o=e.split(" "),i=o[0],s=2<=o.length?slice.call(o,1):[],r=t[n],!r)throw"The handler "+n+" was not found in "+t;return{name:i,selector:s.join(" "),handler:$.proxy(r,t)}}}(this),function(){var i;i=[];for(n in t)r=t[n],i.push(e(n,r));return i}()):[]},e.prototype.addModifier=function(t,e){var n;return null==e&&(e=!1),this.hasModifier(t)?void 0:(this._modifiers[t]=!0,n=function(e){return function(){return e.el?e.el.addClass("is-"+t):void 0}}(this),e?setTimeout(n,20):n())},e.prototype.removeModifier=function(t){return this.hasModifier(t)?(delete this._modifiers[t],this.el?this.el.removeClass("is-"+t):void 0):void 0},e.prototype.hasModifier=function(t){return t in this._modifiers},e.prototype.modifiers=function(){var t;return function(){var e;e=[];for(t in this._modifiers)e.push(t);return e}.call(this)},e}(n.Emitter),{View:e}}),define("fire/util/history",function(t){var e,n,r,i,o,s;return e=0,n="__history_key",i=function(){return e+=1,"history_key_"+e},o=$({}),s=function(t){var e,r;return(r=t.originalEvent.state)?(e=r[n],e?o.trigger(e,r):void 0):void 0},$(window).on("popstate",s),r=function(){function t(t){this.id=i(),o.on(this.id,t)}return t.prototype.push=function(t){var e;if(null==t&&(t={}),t[n]=this.id,history.pushState)try{if(e=JSON.stringify(history.state),JSON.stringify(t)===e)return;return history.pushState(t,document.title,document.location.href)}catch(r){}},t.prototype.pop=function(){return null},t.prototype.remove=function(){return o.off(this.id)},t}(),{getHelper:function(t){return new r(t)}}});var bind=function(t,e){return function(){return t.apply(e,arguments)}},extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/views/ModalView",function(t){var e,n,r,i;return r=t("fire/ui/modal"),i=t("fire/ui/view"),n=t("fire/util/history"),e=function(t){function e(t,r){this.url=t,this.onModalCompleted=bind(this.onModalCompleted,this),e.__super__.constructor.call(this,r),this.enableHistory&&(this.historyHelper=n.getHelper(function(t){return function(e,n){return n&&n.init?t.close():void 0}}(this))),this.preload&&this.getContent()}var i;return extend(e,t),i={},e.prototype.autoRender=!1,e.prototype.preload=!1,e.prototype.show=function(t){var e;return e=$.proxy(this.onClose,this),this.preload&&(t=$.extend({},{resolveBeforeAnimation:!0,close:e},t)),r.showDeferred(this.getContent(),t).always(this.onModalCompleted)},e.prototype.onModalCompleted=function(t){return this.enableHistory&&this.historyHelper.push({init:!0}),this.el=t,this.setup(),this.setupModalEvents(),this.render(),r.position()},e.prototype.close=function(t){return r.close(t)},e.prototype.onClose=function(){return this.closed=!0},e.prototype.setupModalEvents=function(){return null},e.prototype.getContent=function(){var t;return this._loadedContent?$.when(this._loadedContent):(t=this._loadContent(),this.preload&&t.done(function(t){return function(e){return t._loadedContent=e}}(this)),t)},e.prototype._loadContent=function(){var t;return this.preload?null!=i[t=this.url]?i[t]:i[t]=$.get(this.url):$.get(this.url)},e.preloadUrl=function(t){return i[t]=$.get(t)},e}(i.View),{ModalView:e}}),define("fire/util/array",function(t){function e(t){return null===t?null:Array.isArray(t)?t.clone():[t]}function n(t){var e=[];for(var n in t)e.push(n);return e}function r(t,e,n){var r=[];e||(e=t,t=0);for(var i=t;e>i;i++)n?r.push(n.replace(s,i)):r.push(i);return r}var i=Array.prototype,o=!0;i.remove=function(t){for(var n=e(t),r=0;r<n.length;r++){var i=this.indexOf(n[r]);if(-1==i)return this;this.splice(i,1)}return this},i.removeBy=function(t){return this.remove(this.where(t))},i.insert=function(t,e){this.splice(e,0,t)},i.insertBefore=function(t,e){var n=this.indexOf(e);return-1==n?void this.push(t):void this.insert(t,n)},i.insertAfter=function(t,e){var n=this.indexOf(e);return-1==n||n+1>this.length?void this.push(t):void this.insert(t,n+1)},i.clone=i.slice,i.contains=function(t){return-1!=this.indexOf(t)},i.minus=function(t){return this.clone().remove(t)},Array.normalize=e,i.last=function(t){var e=t?this.filter(t):this;return e[e.length-1]},i.first=function(t){var e=t?this.filter(t):this;return e[0]},i.setPush=function(t){return!this.contains(t)&&this.push(t)},i.random=function(){var t=Math.round((this.length-1)*Math.random());return this[t]},i.unique=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e],r=this.indexOf(n);r>-1&&e>r||t.push(n)}return t},i.sum=function(t){for(var e=0,n=0;n<this.length;n++)e+=t?t(this[n]):this[n];return e},i.flatten=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];Array.isArray(n)?n.flatten().forEach(function(e){t.push(e)}):t.push(n)}return t},Array.toObject=function(t){if(!t||!t.length)return{};for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return e},o&&(Array.isArray||(Array.isArray=function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.splice&&!t.propertyIsEnumerable("length")}),i.indexOf||(i.indexOf=function(t){var e=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=e);e>n;n++)if(n in this&&this[n]===t)return n;return-1}),i.some||(i.some=function(t,e){if(!t)return!1;e=e||window;for(var n=0;n<this.length;n++)if(t.call(e,this[n],n))return!0;return!1}),i.forEach||(i.forEach=function(t,e){for(var n=0,r=this.length;r>n;++n)t.call(e||this,this[n],n,this)}),i.filter||(i.filter=function(t,e){var n=[];if(!t)return n;e=e||window;for(var r=0;r<this.length;r++){var i=this[r];t.call(e,i,r)&&n.push(i)}return n}),i.every||(i.every=function(t,e){if(!t)return!0;e=e||window;for(var n=0;n<this.length;n++)if(!t.call(e,this[n],n))return!1;return!0}),i.map||(i.map=function(t,e){if(!t)return this;e=e||window;for(var n=[],r=0;r<this.length;r++)n.push(t.call(e,this[r],r));return n})),i.any=i.some,i.all=i.every,i.each=i.forEach,i.where=i.filter,"jQuery"in window&&["forEach","every","some","sum"].forEach(function(t){jQuery.fn[t]=i[t]});var s=/\{0\}/g;return{toObject:Array.toObject,keys:n,range:r}}),define("fire/net/safe",function(t){"use strict";function e(t,e,i,o){e=e||{},$.extend(e,{_token:u()});var s=$.extend({url:t,type:"POST",success:i,data:e},o),a=$.ajax(s),l=a.then(r,n);return l.success=l.done,l.error=l.fail,l.complete=l.always,l.abort=a.abort,l.setRequestHeader=a.setRequestHeader,l.getAllResponseHeaders=a.getAllResponseHeaders,l.getResponseHeader=a.getResponseHeader,i&&l.done(i),l}function n(t,e,n){var r=$.Deferred();return"abort"===e?r.reject(e,t,n):r.reject(c,t,n),r}function r(t,e,n){var r=$.Deferred();return(!t||t&&!t.status)&&r.resolve(t,e,n),t.status&&("success"===t.status&&r.resolve(t.result,e,n),"error"===t.status&&r.reject(t.message||c,t,e,n)),r}function i(t,e,n){var r=$.Deferred(),i=s(),u=i.attr("name");o(u,r),e=$.extend({},e,{_iframe_id:u}),a(t,e,u,n);var l=r.promise();return l.abort=function(){r.reject("ABORT")},l}function o(t,e){""in window||(window={}),window.smore[t]=function(t){(!t||t&&!t.status)&&e.resolve(t),t.status&&("success"===t.status&&e.resolve(t.result),"error"===t.status&&e.reject(t.message,t))},e.always(function(){delete window.smore[t]})}function s(){var t="iframe_name_"+ ++d,e=$("<iframe/>").css(f).attr("name",t);return $(document.body).append(e),e}function u(t){return t&&(h=t),"function"==typeof h?h():h}function a(t,e,n,r){e=$.extend({_token:u()},e),r||(r=$("<form/>").css(f).appendTo(p)),r.attr({method:"POST",target:n,action:t,enctype:"multipart/form-data"});for(var i in e)$("<input/>").attr({name:i,type:"hidden"}).appendTo(r).val(e[i]);r.submit()}function l(t,e,n,r,i){i=i||"cb";var s="form_cb_name_"+ ++d,u=$.Deferred();o(s,u);var l={};return l[i]=s,e=$.extend(l,e),a(t,e,n,r),u}var c="Something went wrong :-/",p=$("body"),f={visibility:"hidden",width:1,height:1,position:"absolute",left:-1e4,top:-1e4},d=0,h="";return{token:u,post:e,iframe:i,form:a,callbackForm:l}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/validators",function(t){var e,n,r,i;return n=[],r=function(){function t(t){this.field=t}return t.prototype.validate=function(){throw"NotImplemented"},t}(),e=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.message=this.field.options.required,this.message===!0&&(this.message=n)}var n;return extend(e,t),n="This field is required",e.prototype.validate=function(){return this.field.isEmpty()?this.message:void 0},e.isFieldMatch=function(t){return t.options.required},e}(r),n.push(e),i=function(t){var e,r,i,o;for(i=[],e=0,r=n.length;r>e;e++)o=n[e],o.isFieldMatch(t)&&i.push(new o(t));return i},{fromField:i}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fieldView",function(t){var e,n,r;return r=t("fire/ui/view"),n=t("./validators"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.render=function(){return this.name=this.options.name||this.el.attr("name"),this.id=this.options.id||this.el.attr("id"),this.el.attr({name:this.name,id:this.id}),this.setupInputEvents(this.el),this.setupValidators()},e.prototype.setupInputEvents=function(t){return t.on("focus",function(t){return function(e){return t.onInputFocus(e)}}(this)),t.on("blur",function(t){return function(e){return t.onInputBlur(e)}}(this))},e.prototype.setupValidators=function(){return this.validators=n.fromField(this)},e.prototype.onInputFocus=function(t){return this.addModifier("active")},e.prototype.onInputBlur=function(t){return this.removeModifier("active")},e.prototype.onChanged=function(){return this.isEmpty()?this.addModifier("empty"):this.removeModifier("empty"),this.setValid()},e.prototype.validateField=function(){var t;return this.setValid(),t=this.validate(),t?(this.setInvalid(t),!1):!0},e.prototype.validate=function(){var t,e,n,r,i;for(r=this.validators,e=0,n=r.length;n>e;e++)if(i=r[e],t=i.validate())return t},e.prototype.value=function(){return $.trim(this.el.val())},e.prototype.isEmpty=function(){return!this.value()},e.prototype.errorSpan=function(){return $("#"+this.id+"-error")},e.prototype.setInvalid=function(t){return this.addModifier("invalid"),this.trigger("invalid",this),this.errorSpan().show().text(t)},e.prototype.setValid=function(){return this.removeModifier("invalid"),this.trigger("valid",this),this.errorSpan().hide()},e.prototype.enable=function(){return this.removeModifier("disabled")},e.prototype.disable=function(){return this.addModifier("disabled")},e.prototype.focus=function(){return this.el.focus()},e.fromEl=function(t){var n,r,i,o;for(t=$(t),o=e.selectors,n=0,i=o.length;i>n;n++)if(r=o[n],t.is(r.selector))return new r.subclass({el:t});throw console.error("Can't find FieldView for ",t),"Can't find a FieldView for the field "+t},e.selectors=[],e.register=function(t,n){return e.selectors.push({selector:t,subclass:n})},e}(r.View),{FieldView:e}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fields/textFieldView",function(t){var e,n,r;return e="input[type=text],input[type=email],input[type=search],input[type=url],input[type=password],select,textarea",r=t("fire/ui/forms/fieldView"),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.setupInputEvents=function(){return e.__super__.setupInputEvents.apply(this,arguments),this.el.on("input keyup",function(t){return function(e){return t.onInput(e)}}(this)),this.el.on("paste cut",function(t){return function(e){return t.onClipboardTextChanged(e)}}(this))},e.prototype.onInput=function(t){return this.onChanged()},e.prototype.onClipboardTextChanged=function(t){return this.onChanged()},e.prototype.disable=function(){return e.__super__.disable.apply(this,arguments),this.el.attr("disabled",!0)},e.prototype.enable=function(){return e.__super__.enable.apply(this,arguments),this.el.removeAttr("disabled")},e}(r.FieldView),r.FieldView.register(e,n),{TextFieldView:n}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fields/checkboxFieldView",function(t){var e,n,r;return n="input[type=checkbox]",r=t("fire/ui/forms/fieldView"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.value=function(){return this.el.is(":checked")},e}(r.FieldView),r.FieldView.register(n,e),{CheckboxFieldView:e}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fields/radioFieldView",function(t){var e,n,r;return e="div.radio-container",r=t("fire/ui/forms/fieldView"),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.value=function(){return this.el.find("input:radio:checked").val()},e.prototype.setupInputEvents=function(){var t;return e.__super__.setupInputEvents.apply(this,arguments),t=this.el.find("input:radio"),t.on("focus",function(t){return function(e){return t.onInputFocus(e)}}(this)),t.on("blur",function(t){return function(e){return t.onInputBlur(e)}}(this)),t.on("change",function(t){return function(e){return t.onChanged()}}(this))},e}(r.FieldView),r.FieldView.register(e,n),{RadioFieldView:n}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fields/hiddenFieldView",function(t){var e,n,r;return e="input[type=hidden]",r=t("fire/ui/forms/fieldView"),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.setupInputEvents=function(){return e.__super__.setupInputEvents.apply(this,arguments)},e.prototype.disable=function(){return e.__super__.disable.apply(this,arguments),this.el.attr("disabled",!0)},e.prototype.enable=function(){return e.__super__.enable.apply(this,arguments),this.el.removeAttr("disabled")},e}(r.FieldView),r.FieldView.register(e,n),{HiddenFieldView:n}}),define("fire/ui/forms/fields",function(t){var e;return e=t("./fieldView"),t("./fields/textFieldView"),t("./fields/checkboxFieldView"),t("./fields/radioFieldView"),t("./fields/hiddenFieldView"),{FieldView:e.FieldView}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};define("fire/ui/forms/formView",function(t){var e,n,r,i,o,s,u;return r=t("fire/util/array"),u=t("fire/ui/view"),s=t("fire/net/safe"),i=t("./fields"),o=t("fire/util/mobile"),n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}var r,u;return extend(n,t),u=".submit-button,input[type=submit]",r=".error-box",n.prototype.cssClass="form-view",n.prototype.defaultOptions={pleaseWaitText:"Please Wait...",fieldSelector:".form-field",deliveryMethod:"ajax",validationErrorMessage:"Some of the fields are invalid.",deliveryDelay:300},n.prototype.render=function(){return this.setupFields(),this.setupSubmitButton(),this.errorBox=this.find(r).hide(),this.options.action?void 0:this.options.action=this.el.attr("action")},n.prototype.setupFields=function(){var t,e,n,r,o;for(this.fields=[],r=this.find(this.options.fieldSelector),o=[],e=0,n=r.length;n>e;e++)t=r[e],o.push(this.fields.push(new i.FieldView.fromEl(t)));return o},n.prototype.setupSubmitButton=function(){return this.submitButton=this.find(u),this.options.submitText?this.submitButtonText(this.options.submitText):this.options.submitText=$.trim(this.submitButtonText()),this.submitButton.click(function(t){return function(e){return t.onSubmitButtonClicked(e)}}(this))},n.prototype.onSubmitButtonClicked=function(t){return t.stopPropagation(),t.preventDefault(),this.submit()},n.prototype.submit=function(){return this.hasModifier("disabled")||this.hasModifier("submitting")?!1:this.validateForm()?(this.deliverForm(),!0):!1},n.prototype.reset=function(){return this.cleanup(),this.hideErrors(),this.el[0].reset()},n.prototype.deliverForm=function(){var t,e,n;switch(this.addModifier("submitting"),this.trigger("submitstart",this),this.submitButtonText(this.options.pleaseWaitText),this.disable(),e=this.values(),n=this.options.action,t=$.Deferred(),this.options.deliveryMethod){case"ajax":t=s.post(n,e);break;case"form":s.form(n,e);break;case"iframe":t=s.iframe(n,e);break;default:throw"Bad deliveryMethod: "+this.options.deliveryMethod}return t.done(function(t){return function(e){return t.onDeliveryCompleted(e)}}(this)),t.fail(function(t){return function(e,n){return t.onDeliveryFailed(e,n)}}(this)),t.promise()},n.prototype.onDeliveryCompleted=function(t){return this.result=t,setTimeout(function(e){return function(){return e.trigger("success",e,t),e.cleanup()}}(this),this.options.deliveryDelay)},n.prototype.onDeliveryFailed=function(t,n){return this.result=null,setTimeout(function(r){return function(){return r.errors=new e,r.processServerErrors(t,n,r.errors),r.trigger("fail",r,r.error),r.showErrors(),r.cleanup()}}(this),this.options.deliveryDelay)},n.prototype.processServerErrors=function(t,e,n){return n.add("server_error",t,"server_error")},n.prototype.cleanup=function(){return this.removeModifier("submitting"),this.trigger("submitcomplete",this),this.submitButtonText(this.options.submitText),this.enable()},n.prototype.submitButtonText=function(t){return this.submitButton.is("input")?t?this.submitButton.val(t):this.submitButton.val():t?this.submitButton.text(t):this.submitButton.text()},n.prototype.values=function(){var t,e,n,r,i;for(i=$.extend({},this.options.extraParams),r=this.fields,e=0,n=r.length;n>e;e++)t=r[e],i[t.name]=t.value();return i},n.prototype.validateForm=function(){var t,n;return this.errors=new e,this.validate(this.fields,this.errors),n=function(){var e,n,r,i;for(r=this.fields,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.validateField());return i}.call(this),indexOf.call(n,!1)>=0&&this.errors.add("validation_error",this.options.validationErrorMessage),this.errors.length?(this.trigger("invalid",this),this.addModifier("invalid"),this.showErrors(),!1):(this.trigger("valid",this),this.removeModifier("invalid"),this.hideErrors(),!0)},n.prototype.validate=function(t,e){return null},n.prototype.showErrors=function(){var t,e,n,r,i;for(e="",i=this.errors.errors,n=0,r=i.length;r>n;n++)t=i[n],t.description&&(e+="<p>"+t.description+"</p>");return e?this.errorBox.html(e).show():void 0},n.prototype.setError=function(t){return this.errors=new e,this.errors.add("custom",t),this.showErrors()},n.prototype.hideErrors=function(){return this.errorBox.hide()},n.prototype.disable=function(){var t,e,n,r;for(this.addModifier("disabled"),r=this.fields,e=0,n=r.length;n>e;e++)t=r[e],t.disable();return this.submitButton.addClass("is-disabled")},n.prototype.enable=function(){var t,e,n,r;for(this.removeModifier("disabled"),r=this.fields,e=0,n=r.length;n>e;e++)t=r[e],t.enable();return this.submitButton.removeClass("is-disabled")},n.prototype.field=function(t){return this.fields.filter(function(e){return e.name===t})[0]},n.prototype.focus=function(t){var e,n;return null==t&&(t=null),o.isPhone()?void 0:t?null!=(e=this.field(t))?e.focus():void 0:null!=(n=this.fields[0])?n.focus():void 0},n}(u.View),e=function(){function t(){this.clear()}return t.prototype.add=function(t,e,n){return null==n&&(n=null),this.errors.push({name:t,description:e,type:n}),this.length+=1},t.prototype.clear=function(){return this.errors=[],this.length=0},t}(),{FormView:n}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/signupFormView",function(t){var e,n;return n=t("fire/ui/forms/formView"),e=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.options.validationErrorMessage=""}return extend(e,t),e.prototype.processServerErrors=function(t,e,n){var r,i,o,s,u,a,l,c;switch(t){case"invalid":for(l=e.code,i="",o=0,s=l.length;s>o;o++)u=l[o],r=u[0],a=u[1],null!=(c=this.field(r))&&c.setInvalid(a),i=i||a;return n.add("invalid",!1);case"tryfacebook":return n.add("tryfacebook","Try logging in with your Facebook account.");case"trygoogle":return n.add("trygoogle","Try logging in with your Google account.");case"tryemail":return n.add("tryemail","Try logging in with your email.");
case"user exists":return n.add("user exists","We already have a user with that email. Try logging in instead.","field_error",{target:"email"});default:return n.add("unkown","Something is broken. Try again later :(")}},e}(n.FormView),{SignupFormView:e}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/loginFormView",function(t){var e,n;return n=t("fire/ui/forms/formView"),e=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.options.validationErrorMessage=""}return extend(e,t),e.prototype.processServerErrors=function(t,e,n){switch(t){case"tryfacebook":return n.add("tryfacebook","Try logging in with your Facebook account.");case"trygoogle":return n.add("tryfacebook","Try logging in with your Google account.");case"invaliduser":return n.add("invaliduser","Please enter your email","field_error",{target:"email"});case"nouser":return n.add("nouser","Wrong email or password","field_error",{target:"email"});case"tryemail":return n.add("tryemail","Try logging in with your email.");case"badpassword":return n.add("badpassword","Wrong email or password","field_error",{target:"email"});default:return n.add("unkown","Something is broken. Try again later :(")}},e}(n.FormView),{LoginFormView:e}}),define("fire/util/strings",function(t){function e(t,e){for(var n=arguments[0],r=0;r<arguments.length-1;r++){var i=new RegExp("\\{"+r+"\\}","gm");n=n.replace(i,arguments[r+1])}return n}var n=String.prototype;return n.format=e,{format:e}}),define("fire/net/popup",function(t){function e(t,e,o,s){function c(t){if("pending"===p.state()){switch(t&&"object"==typeof t||p.reject("NO_DATA"),t.status){case"success":p.resolve(t.result);break;case"error":p.reject(t.message);break;default:p.reject(u)}delete window[f]}}if(!t)throw"Url must be defined!";s=s||"cb";var p=$.Deferred(),f="__pop_cb_"+ ++l;window[f]=c;var d=n(t,s,f),h=r(d,e,o,function(){c({status:"error",message:a})}),v=p.promise();return v.abort=function(){i(h,p)},v}function n(t,e,n){var r=e+"="+n;return-1!==t.indexOf("%{cb}")?t.replace("%{cb}",r):-1===t.indexOf("?")?t+"?"+r:t+"&"+r}function r(t,e,n,r,i){var s=window.open(t,i||"",o(e,n)),u=setInterval(function(){(!s||s.closed)&&(clearInterval(u),r())},20);return s}function i(t,e){if("pending"===e.state())try{t.close()}catch(n){}}function o(t,e){return s.format("width={0},height={1},location=no,status=no",t,e)}var s=t("fire/util/strings"),u="NO_DATA",a="POPUP_CLOSED",l=0;return{open:e,openPopup:r}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/facebookConnectView",function(t){var e,n,r;return r=t("fire/ui/view"),n=t("fire/net/popup"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return extend(e,t),r={width:600,height:450},e.prototype.cssClass="facebook-connect-button",e.prototype.events={click:"onConnectClicked"},e.prototype.defaultOptions={pleaseWaitText:"Please wait...",connectUrl:"/app/users/connect"},e.prototype.render=function(){return this.textSpan=this.find(".text-content"),this.options.text?this.textSpan.text(this.options.text):this.options.text=$.trim(this.textSpan.text())},e.prototype.onConnectClicked=function(t){return this.hasModifier("disabled")||this.hasModifier("connecting")?void 0:(this.addModifier("connecting"),this.trigger("connectstart",this),this.disable(),this.textSpan.text(this.options.pleaseWaitText),this.popup=n.open(this.generateUrl(),r.width,r.height),this.popup.done(function(t){return function(e){return t.onPopupComplete(e)}}(this)),this.popup.fail(function(t){return function(e){return t.onPopupFailed(e)}}(this)))},e.prototype.generateUrl=function(){var t,e,n;return t=$.extend({},this.options.connectParams),this.options.buttonId&&(t.signup_button=this.options.buttonId),this.options.signupSegment&&(t.segment=this.options.signupSegment),e=$.param(t),n=this.options.connectUrl,n+=n.indexOf("?")>0?"&":"?",n+e},e.prototype.onPopupComplete=function(t){var e;return e=t.is_new?"signup":"login",this.trigger("success",this,e,t),this.trigger(e,this,t),this.cleanup()},e.prototype.onPopupFailed=function(t){switch(t){case"POPUP_CLOSED":case"fb_cancel":this.trigger("cancel",this);break;default:this.trigger("fail",this,t)}return this.cleanup()},e.prototype.cleanup=function(){return this.textSpan.text(this.options.text),this.removeModifier("connecting"),this.trigger("connectcomplete",this),this.enable(),this.popup.abort()},e.prototype.enable=function(){return this.removeModifier("disabled")},e.prototype.disable=function(){return this.addModifier("disabled")},e.prototype.beforeRemove=function(){var t;return null!=(t=this.popup)?t.abort():void 0},e}(r.View),{FacebookConnectView:e}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/googleConnectView",function(t){var e,n;return n=t("fire/ui/view"),e=function(t){function e(t){e.__super__.constructor.call(this,t),this.setupGoogleConnect()}return extend(e,t),e.prototype.cssClass="google-connect-button",e.prototype.events={click:"onConnectClicked"},e.prototype.defaultOptions={pleaseWaitText:"Please wait...",connectUrl:"/app/users/google_connect"},e.prototype.render=function(){return this.textSpan=this.find(".text-content"),this.options.text?this.textSpan.text(this.options.text):this.options.text=$.trim(this.textSpan.text())},e.prototype.setupGoogleConnect=function(){return gapi.load("auth2",function(t){return function(){var t;try{return gapi.auth2.init({client_id:window.__google_connect_client_id,cookiepolicy:"single_host_origin"})}catch(e){return t=e,console.log(t)}}}(this))},e.prototype.onConnectClicked=function(t){return this.hasModifier("disabled")||this.hasModifier("connecting")?void 0:(this.addModifier("connecting"),this.trigger("connectstart",this),this.disable(),this.textSpan.text(this.options.pleaseWaitText),gapi.auth2.getAuthInstance().signIn().then(function(t){return function(e){return t.onGoogleConnectSuccess(e)}}(this),function(t){return function(e){return t.onGoogleConnectError(e.error)}}(this)))},e.prototype.onServerSignupWithGoogle=function(t){var e,n;return"success"!==t.status?this.onGoogleConnectError(t.message):(n=t.result,e=n.is_new?"signup":"login",this.trigger("success",this,e,n),this.trigger(e,this,n),this.cleanup())},e.prototype.onGoogleConnectSuccess=function(t){var e;return e={idtoken:t.getAuthResponse().id_token},this.options.buttonId&&(e.signup_button=this.options.buttonId),this.options.signupSegment&&(e.segment=this.options.signupSegment),$.post("/app/users/google_login",e).done(function(t){return function(e){return t.onServerSignupWithGoogle(e)}}(this)).fail(function(t){return function(e){return t.onGoogleConnectError(e)}}(this))},e.prototype.onGoogleConnectError=function(t){switch(t){case"popup_closed_by_user":this.trigger("cancel",this);break;default:this.trigger("fail",this,t)}return this.cleanup()},e.prototype.cleanup=function(){return this.textSpan.text(this.options.text),this.removeModifier("connecting"),this.trigger("connectcomplete",this),this.enable()},e.prototype.enable=function(){return this.removeModifier("disabled")},e.prototype.disable=function(){return this.addModifier("disabled")},e}(n.View),{GoogleConnectView:e}}),define("smore/util/report",function(t){var e,n,r,i;return e=300,n={},i=function(t,i,o){var s,u,a;if(null==i&&(i={}),null==o&&(o=!1),s=window.analytics,!t||!s.track)return void(DEVMODE&&console.error("analytics is not loaded or event name wasn't provided!"));if(i=$.extend(r(),i),o&&window.JSON){if(a=t+"-"+JSON.stringify(i),a in n)return;n[a]=!0}return u=$.Deferred(),DEVMODE&&console.log("%cevent:","color:green",t,i,o),s.track(t,i,u.resolve),setTimeout(u.reject,e),u.promise()},r=function(){var t,e,n,r,i,o;for(o={},e=$(".smore-ab-test-meta"),n=0,i=e.length;i>n;n++)t=e[n],r=t.getAttribute("key"),r&&(o["ab_test_"+r]=t.getAttribute("content"));return o},{track:i,ab:r}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/modal",function(t){var e,n,r,i,o,s,u,a,l,c,p,f,d;return c=t("fire/ui/views/ModalView"),f=t("./signupFormView"),l=t("./loginFormView"),s=t("./facebookConnectView"),u=t("./googleConnectView"),p=t("smore/util/report"),e="/app/users/login_modal",DEVMODE&&(e+="?_t="+Number(new Date)),i={cssClass:"base-modal login-modal",width:406,overlayClose:!0,overlayClass:"login-modal-overlay"},n="/app",r=function(t){function r(t){r.__super__.constructor.call(this,e,t),this.state=this.options.state}var o;return extend(r,t),o={login_modal_open:"LOGIN MODAL: Open"},r.prototype.preload=!0,r.prototype.enableHistory=!0,r.prototype.events={"click .switch-state":"onSwitchStateClicked"},r.prototype.defaultOptions={state:"signup"},r.prototype.render=function(){var t,e,n;return t=this.options.buttonId,n={signup_button:t},e=this._signupSegment(),e&&(n.segment=e),this.loginForm=new l.LoginFormView({el:this.find(".login-form")}),this.loginForm.on("success",function(t){return function(e,n){return t.onSuccess("login",n)}}(this)),this.signupForm=new f.SignupFormView({el:this.find(".signup-form"),extraParams:n}),this.signupForm.on("success",function(t){return function(e,n){return t.onSuccess("signup",n)}}(this)),this.signupGoogleConnect=new u.GoogleConnectView({el:this.find(".only-signup .google-connect-button"),buttonId:t,signupSegment:e}),this.signupGoogleConnect.on("success",function(t){return function(e,n,r){return t.onSuccess(n,r)}}(this)).on("fail",function(t){return function(e,n){return t.onSignupFailed(n)}}(this)),this.loginGoogleConnect=new u.GoogleConnectView({el:this.find(".only-login .google-connect-button"),buttonId:t,signupSegment:e}),this.loginGoogleConnect.on("success",function(t){return function(e,n,r){return t.onSuccess(n,r)}}(this)).on("fail",function(t){return function(e,n){return t.onLoginFailed(n)}}(this)),this.signupfbConnect=new s.FacebookConnectView({el:this.find(".only-signup .facebook-connect-button"),buttonId:t,signupSegment:e}),this.signupfbConnect.on("success",function(t){return function(e,n,r){return t.onSuccess(n,r)}}(this)).on("fail",function(t){return function(e,n){return t.onSignupFailed(n)}}(this)),this.loginfbConnect=new s.FacebookConnectView({el:this.find(".only-login .facebook-connect-button"),buttonId:t,signupSegment:e}),this.loginfbConnect.on("success",function(t){return function(e,n,r){return t.onSuccess(n,r)}}(this)).on("fail",function(t){return function(e,n){return t.onLoginFailed(n)}}(this)),this.setState(this.state),this.setupDisableState(this.loginForm,this.loginfbConnect,this.loginGoogleConnect),this.setupDisableState(this.signupForm,this.signupfbConnect,this.signupGoogleConnect)},r.prototype._signupSegment=function(){return $('meta[name="smore:signup_segment"]').attr("value")},r.prototype.setupDisableState=function(t,e,n){return t.on("submitstart",function(t){return function(r){return e.disable(),n.disable(),t.addModifier("pending",!0)}}(this)),t.on("submitcomplete",function(t){return function(r){return e.enable(),n.enable(),t.removeModifier("pending")}}(this)),e.on("connectstart",function(e){return function(r){return t.disable(),n.disable(),e.addModifier("pending",!0)}}(this)),e.on("connectcomplete",function(e){return function(r){return t.enable(),n.enable(),e.removeModifier("pending")}}(this)),n.on("connectstart",function(n){return function(r){return t.disable(),e.disable(),n.addModifier("pending",!0)}}(this)),n.on("connectcomplete",function(n){return function(r){return t.enable(),e.enable(),n.removeModifier("pending")}}(this))},r.prototype.setState=function(t){return this.removeModifier(this.state),this.addModifier(t),this.state=t,"login"===t?this.loginForm.focus():this.signupForm.focus()},r.prototype.onSwitchStateClicked=function(t){var e;return e=$(t.currentTarget).data("target"),e?this.setState(e):void 0},r.prototype.show=function(){return r.__super__.show.call(this,i),window.ga?ga("send","pageview","/app/users/signup_modal"):void 0},r.prototype.onSuccess=function(t,e){var r;if(!this.closed)return this.options.onSuccess?this.options.onSuccess(this,t,e):($("body").hide(),this.options.reloadOnly?document.location.reload():(r=e.redirect_url||n,"app/reporting/report_errors"===r&&(r="/app"),document.location=r))},r.prototype.onLoginFailed=function(t){return this.handleFailure(t,this.loginForm)},r.prototype.onSignupFailed=function(t){return this.handleFailure(t,this.signupForm)},r.prototype.handleFailure=function(t,e){var n;return n="Something is broken. Try again later: (","tryemail"===t&&(n="Try logging in with your email"),"trygoogle"===t&&(n="Try logging in with your Google account"),"tryfacebook"===t&&(n="Try logging in with your Facebook account"),e.setError(n)},r.prototype.onClose=function(){return r.__super__.onClose.apply(this,arguments),this.signupfbConnect.remove(),this.loginfbConnect.remove()},r}(c.ModalView),d=function(t,e){var n,i;return null==e&&(e={}),i=$.extend({},t.data(),e),n=new r(i),n.show(),n},a=function(){var t;return t=document.cookie.match(/_L="?([A-Za-z0-9\+\/\\]*)"?/),t&&t.length>=2},o=function(){return $(".auto-quick-login").on("click",function(t){var e;return t.preventDefault(),e=$(t.currentTarget),d(e)}),c.ModalView.preloadUrl(e)},$(o),{LoginModalView:r,show:d,isLoggedIn:a}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("marketing/flat/sections/sliderView",function(t){var e,n;return n=t("fire/ui/view"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var n;return extend(e,t),n="slider-active",e.prototype.render=function(){return this._items=this.find(".slider-item"),this.go(0)},e.prototype.go=function(t){var e;return e=this._items[t],e?$(e).addClass(n).siblings().removeClass(n):void(DEVMODE&&console.error("Can't find slider item with index: "+t))},e.prototype.next=function(){var t,e;return t=this._items.filter("."+n).index(),e=(t+1)%this._items.length,this.go(e)},e.prototype.prev=function(){var t,e;return t=this._items.filter("."+n).index(),e=0===t?this._items.length-1:t-1,this.go(e)},e}(n.View),{SliderView:e}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("marketing/flat/sections/header",function(t){var e,n,r;return r=t("fire/ui/view"),n=t("./sliderView"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return extend(e,t),r=4e3,e.prototype.render=function(){var t,e;return t=this.find(".flyers .frame"),t.length?(e=new n.SliderView({el:this.find(".flyers .frame")}),setInterval(function(){return e.next()},r)):void 0},e}(r.View),{HeaderSectionView:e}}),function(){var t=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},e=[].slice;!function(t,e){return"function"==typeof define&&define.amd?define("waypoints",["jquery"],function(n){return e(n,t)}):e(t.jQuery,t)}(this,function(n,r){var i,o,s,u,a,l,c,p,f,d,h,v,y,g,m,w;return i=n(r),p=t.call(r,"ontouchstart")>=0,u={horizontal:{},vertical:{}},a=1,c={},l="waypoints-context-id",h="resize.waypoints",v="scroll.waypoints",y=1,g="waypoints-waypoint-ids",m="waypoint",w="waypoints",o=function(){function t(t){var e=this;this.$element=t,this.element=t[0],this.didResize=!1,this.didScroll=!1,this.id="context"+a++,this.oldScroll={x:t.scrollLeft(),y:t.scrollTop()},this.waypoints={horizontal:{},vertical:{}},t.data(l,this.id),c[this.id]=this,t.bind(v,function(){var t;return e.didScroll||p?void 0:(e.didScroll=!0,t=function(){return e.doScroll(),e.didScroll=!1},r.setTimeout(t,n[w].settings.scrollThrottle))}),t.bind(h,function(){var t;return e.didResize?void 0:(e.didResize=!0,t=function(){return n[w]("refresh"),e.didResize=!1},r.setTimeout(t,n[w].settings.resizeThrottle))})}return t.prototype.doScroll=function(){var t,e=this;return t={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},!p||t.vertical.oldScroll&&t.vertical.newScroll||n[w]("refresh"),n.each(t,function(t,r){var i,o,s;return s=[],o=r.newScroll>r.oldScroll,i=o?r.forward:r.backward,n.each(e.waypoints[t],function(t,e){var n,i;return r.oldScroll<(n=e.offset)&&n<=r.newScroll?s.push(e):r.newScroll<(i=e.offset)&&i<=r.oldScroll?s.push(e):void 0}),s.sort(function(t,e){return t.offset-e.offset}),o||s.reverse(),n.each(s,function(t,e){return e.options.continuous||t===s.length-1?e.trigger([i]):void 0})}),this.oldScroll={x:t.horizontal.newScroll,y:t.vertical.newScroll}},t.prototype.refresh=function(){var t,e,r,i=this;return r=n.isWindow(this.element),e=this.$element.offset(),this.doScroll(),t={horizontal:{contextOffset:r?0:e.left,contextScroll:r?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:r?0:e.top,contextScroll:r?0:this.oldScroll.y,contextDimension:r?n[w]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},n.each(t,function(t,e){return n.each(i.waypoints[t],function(t,r){var i,o,s,u,a;return i=r.options.offset,s=r.offset,o=n.isWindow(r.element)?0:r.$element.offset()[e.offsetProp],n.isFunction(i)?i=i.apply(r.element):"string"==typeof i&&(i=parseFloat(i),r.options.offset.indexOf("%")>-1&&(i=Math.ceil(e.contextDimension*i/100))),r.offset=o-e.contextOffset+e.contextScroll-i,r.options.onlyOnScroll&&null!=s||!r.enabled?void 0:null!==s&&s<(u=e.oldScroll)&&u<=r.offset?r.trigger([e.backward]):null!==s&&s>(a=e.oldScroll)&&a>=r.offset?r.trigger([e.forward]):null===s&&e.oldScroll>=r.offset?r.trigger([e.forward]):void 0})})},t.prototype.checkEmpty=function(){return n.isEmptyObject(this.waypoints.horizontal)&&n.isEmptyObject(this.waypoints.vertical)?(this.$element.unbind([h,v].join(" ")),delete c[this.id]):void 0},t}(),s=function(){function t(t,e,r){var i,o;r=n.extend({},n.fn[m].defaults,r),"bottom-in-view"===r.offset&&(r.offset=function(){var t;return t=n[w]("viewportHeight"),n.isWindow(e.element)||(t=e.$element.height()),t-n(this).outerHeight()}),this.$element=t,this.element=t[0],this.axis=r.horizontal?"horizontal":"vertical",this.callback=r.handler,this.context=e,this.enabled=r.enabled,this.id="waypoints"+y++,this.offset=null,this.options=r,e.waypoints[this.axis][this.id]=this,u[this.axis][this.id]=this,i=null!=(o=t.data(g))?o:[],i.push(this.id),t.data(g,i)}return t.prototype.trigger=function(t){return this.enabled?(null!=this.callback&&this.callback.apply(this.element,t),this.options.triggerOnce?this.destroy():void 0):void 0},t.prototype.disable=function(){return this.enabled=!1},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0},t.prototype.destroy=function(){return delete u[this.axis][this.id],delete this.context.waypoints[this.axis][this.id],this.context.checkEmpty()},t.getWaypointsByElement=function(t){var e,r;return(r=n(t).data(g))?(e=n.extend({},u.horizontal,u.vertical),n.map(r,function(t){return e[t]})):[]},t}(),d={init:function(t,e){var r;return null==e&&(e={}),null==(r=e.handler)&&(e.handler=t),this.each(function(){var t,r,i,u;return t=n(this),i=null!=(u=e.context)?u:n.fn[m].defaults.context,n.isWindow(i)||(i=t.closest(i)),i=n(i),r=c[i.data(l)],r||(r=new o(i)),new s(t,r,e)}),n[w]("refresh"),this},disable:function(){return d._invoke(this,"disable")},enable:function(){return d._invoke(this,"enable")},destroy:function(){return d._invoke(this,"destroy")},prev:function(t,e){return d._traverse.call(this,t,e,function(t,e,n){return e>0?t.push(n[e-1]):void 0})},next:function(t,e){return d._traverse.call(this,t,e,function(t,e,n){return e<n.length-1?t.push(n[e+1]):void 0})},_traverse:function(t,e,i){var o,s;return null==t&&(t="vertical"),null==e&&(e=r),s=f.aggregate(e),o=[],this.each(function(){var e;return e=n.inArray(this,s[t]),i(o,e,s[t])}),this.pushStack(o)},_invoke:function(t,e){return t.each(function(){var t;return t=s.getWaypointsByElement(this),n.each(t,function(t,n){return n[e](),!0})}),this}},n.fn[m]=function(){var t,r;return r=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],d[r]?d[r].apply(this,t):n.isFunction(r)?d.init.apply(this,arguments):n.isPlainObject(r)?d.init.apply(this,[null,r]):r?n.error("The "+r+" method does not exist in jQuery Waypoints."):n.error("jQuery Waypoints needs a callback function or handler option.")},n.fn[m].defaults={context:r,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},f={refresh:function(){return n.each(c,function(t,e){return e.refresh()})},viewportHeight:function(){var t;return null!=(t=r.innerHeight)?t:i.height()},aggregate:function(t){var e,r,i;return e=u,t&&(e=null!=(i=c[n(t).data(l)])?i.waypoints:void 0),e?(r={horizontal:[],vertical:[]},n.each(r,function(t,i){return n.each(e[t],function(t,e){return i.push(e)}),i.sort(function(t,e){return t.offset-e.offset}),r[t]=n.map(i,function(t){return t.element}),r[t]=n.unique(r[t])}),r):[]},above:function(t){return null==t&&(t=r),f._filter(t,"vertical",function(t,e){return e.offset<=t.oldScroll.y})},below:function(t){return null==t&&(t=r),f._filter(t,"vertical",function(t,e){return e.offset>t.oldScroll.y})},left:function(t){return null==t&&(t=r),f._filter(t,"horizontal",function(t,e){return e.offset<=t.oldScroll.x})},right:function(t){return null==t&&(t=r),f._filter(t,"horizontal",function(t,e){return e.offset>t.oldScroll.x})},enable:function(){return f._invoke("enable")},disable:function(){return f._invoke("disable")},destroy:function(){return f._invoke("destroy")},extendFn:function(t,e){return d[t]=e},_invoke:function(t){var e;return e=n.extend({},u.vertical,u.horizontal),n.each(e,function(e,n){return n[t](),!0})},_filter:function(t,e,r){var i,o;return(i=c[n(t).data(l)])?(o=[],n.each(i.waypoints[e],function(t,e){return r(i,e)?o.push(e):void 0}),o.sort(function(t,e){return t.offset-e.offset}),n.map(o,function(t){return t.element})):[]}},n[w]=function(){var t,n;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],f[n]?f[n].apply(null,t):f.aggregate.call(null,n)},n[w].settings={resizeThrottle:100,scrollThrottle:30},i.load(function(){return n[w]("refresh")})})}.call(this),define("lib/waypoints",function(){return $.waypoints});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/scrollWatcher",function(t){var e,n,r,i;return r=t("fire/util/eventEmitter"),i=t("lib/waypoints"),e={startOffset:0,endOffset:1},n=function(t){function n(t,r){null==r&&(r=e),n.__super__.constructor.apply(this,arguments),this.el=$(t),this._current=null,this._setupBreakpoint({side:"bos",scroll:"in",dir:"down",point:r.startOffset}),this._setupBreakpoint({side:"tos",scroll:"in",dir:"up",point:r.startOffset}),this._setupBreakpoint({side:"tos",scroll:"out",dir:"down",point:r.endOffset}),this._setupBreakpoint({side:"bos",scroll:"out",dir:"up",point:r.startOffset}),this._testInView(r)}return extend(n,t),n.prototype._testInView=function(t){var e,n,r,i,o,s;return i=$.waypoints("viewportHeight"),e=this.el.outerHeight(),n=this.el.offset(),r=$("body").scrollTop(),s=i-(n.top-r+e)>0,o=r<n.top+e,o&&s?this.inView=!0:void 0},n.prototype._setupBreakpoint=function(t){var e,n,r,i,o,s;return o=t.side,r=t.point,i=t.scroll,e=t.dir,s=function(t){return function(n){return n===e&&t._current!==i?(t._current=i,t.trigger("scroll"+i,t)):void 0}}(this),n=function(){var t,e,n;return e=$(this).outerHeight(),t=e*r,"tos"===o?-t:(n=$.waypoints("viewportHeight"),n-t)},this.el.waypoint(s,{offset:n})},n}(r.Emitter),{ScrollWatcher:n}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("marketing/flat/sections/ambientVideoView",function(t){var e,n,r,i;return i=t("fire/ui/view"),r=t("fire/ui/scrollWatcher"),n=t("fire/util/mobile"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.events={"click .pause":"_onPauseClicked","click .play":"_onPlayClicked","click .replay":"_onReplayClicked"},e.prototype.render=function(){return this._video=this.find("video"),this._video[0].loop=!1,$.isFunction(this._video[0].play)||(this._noVideo=!0,this._video.hide(),this.find(".poster").attr("style","display:block;!important")),n.isTablet()?(this._video.prop("controls",!0),void this.setState("tablet-manual-playing")):(this._video.on("ended",function(t){return function(){return t._onVideoEnded()}}(this)),this.setState("waiting"),this._sw=new r.ScrollWatcher(this.el,{startOffset:.5,endOffset:1}),this._sw.on("scrollin",function(t){return function(){return t._onVideoScrollIn()}}(this)),this._sw.on("scrollout",function(t){return function(){return t._onVideoScrollOut()}}(this)),this._sw.inView?this._onVideoScrollIn():void 0)},e.prototype.setState=function(t){return this._state&&this.removeModifier(this._state),this.addModifier(t),this._state=t},e.prototype._playVideo=function(){return this._noVideo?void 0:this._video[0].play()},e.prototype._pauseVideo=function(){return this._noVideo?void 0:this._video[0].pause()},e.prototype._rewindVideo=function(){return this._video[0].currentTime=0},e.prototype._onVideoEnded=function(){return this.setState("completed")},e.prototype._onPauseClicked=function(t){return this._pauseVideo(),this.setState("paused")},e.prototype._onPlayClicked=function(t){return this._playVideo(),this.setState("manual-playing")},e.prototype._onReplayClicked=function(t){return this._rewindVideo(),this._playVideo(),this.setState("manual-playing")},e.prototype._onVideoScrollIn=function(){return"waiting"===this._state&&this._video.is(":visible")?(this.setState("playing"),this._playVideo()):void 0},e.prototype._onVideoScrollOut=function(){return"playing"===this._state?(this.setState("waiting"),this._pauseVideo(),this._rewindVideo()):void 0},e}(i.View),{AmbientVideoView:e}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("marketing/flat/sections/editor",function(t){var e,n,r,i;return i=t("fire/ui/view"),r=t("fire/util/mobile"),n=t("./ambientVideoView"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.render=function(){var t;if(!r.isPhone())return t=new n.AmbientVideoView({el:this.find(".frame")})},e}(i.View),{EditorSectionView:e}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("marketing/flat/sections/promotion",function(t){var e,n,r,i,o,s;return s=t("fire/ui/view"),o=t("fire/util/mobile"),i=t("fire/util/array"),r=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}var i;return extend(r,t),i=4,r.prototype.events={"click .traffic-sources .title-bar":"onSourceTitlebarClicked"},r.prototype.render=function(){var t,r,i,s,u;if(!o.isPhone()){for(this._animationBars={},this._sources=[],s=this.find(".source"),r=0,i=s.length;i>r;r++)t=s[r],t=$(t),u=t.data("source"),this._animationBars[u]=new e(t),this._sources.push(u);return this._counter=new n(this.find(".view-counter")),this.randomAnimation()}},r.prototype.onSourceTitlebarClicked=function(t){var e,n;return n=$(t.currentTarget),e=n.parent(".source"),this.animate(e.data("source")),e.hasClass("extended")?void 0:e.addClass("extended").siblings().removeClass("extended")},r.prototype.animate=function(t,e){var n;return null==e&&(e=!1),(n=this._animationBars[t])?n.animate(function(t){return function(){return t._counter.incr(),e?e():void 0}}(this)):void 0},r.prototype.randomAnimation=function(){var t;return t=this._sources.random(),this.animate(t,function(t){return function(){var e;return e=Math.round(Math.random()*i),setTimeout(function(){return t.randomAnimation()},1e3*e)}}(this))},r}(s.View),e=function(){function t(t){this.ul=$("<ul><li/><li/><li/><li/><li/></ul>").addClass("source-animation no-mobile").prependTo(t),this.lis=this.ul.children()}var e,n;return n=300,e=200,t.prototype.animate=function(t){var r,i,o,s,u,a;for(s=this.lis,o=s.length,a=[],r=i=u=o;0>=u?0>=i:i>=0;r=0>=u?++i:--i)a.push(function(r){var i;return i=$(s[r]),setTimeout(function(){return i.addClass("beep"),setTimeout(function(){return i.removeClass("beep"),0===r?t():void 0},e)},n*(o-r))}(r));return a},t}(),n=function(){function t(t){this.el=t,this._viewsSpan=this.el.find(".views"),this._views=Number(this._viewsSpan.text())}return t.prototype.incr=function(){return this._views+=1,this._viewsSpan.text(this._views),this.highlight()},t.prototype.highlight=function(){var t;return t=this.el,t.removeClass("animating"),t.addClass("highlighted"),setTimeout(function(){return t.addClass("animating"),setTimeout(function(){return t.removeClass("highlighted")},20)},20)},t}(),{PromotionSectionView:r}});var extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("marketing/flat/sections/analytics",function(t){var e,n;return n=t("fire/ui/view"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.events={"click .forward-arrow":"onForwardArrowClicked","click .back-arrow":"onBackArrowClicked","click .image-selector li":"onImageSelectorItemClicked"},e.prototype.render=function(){return this.galleryItems=this.find(".image-frame"),this.selectorItems=this.find(".image-selector li")},e.prototype.onForwardArrowClicked=function(t){return t.preventDefault(),this.galleryForward()},e.prototype.onBackArrowClicked=function(t){return t.preventDefault(),this.galleryBack()},e.prototype.onImageSelectorItemClicked=function(t){var e,n;return n=$(t.currentTarget),n.hasClass("selected")?void 0:(e=n.index(),this.galleryGo(e))},e.prototype.galleryGo=function(t){var e;return(e=this.galleryItems[t])?($(e).addClass("selected").siblings().removeClass("selected"),$(this.selectorItems[t]).addClass("selected").siblings().removeClass("selected")):void(DEVMODE&&console.error("Can't find gallery item with index: "+t))},e.prototype.galleryForward=function(){var t,e;return t=this.galleryItems.filter(".selected").index(),e=(t+1)%this.galleryItems.length,this.galleryGo(e)},e.prototype.galleryBack=function(){var t,e;return t=this.galleryItems.filter(".selected").index(),e=0===t?this.galleryItems.length-1:t-1,this.galleryGo(e)},e}(n.View),{AnalyticsSectionView:e}}),define("marketing/flat/landingpage",function(t){var e,n,r,i,o,s;return r=t("smore/ui/login/modal"),e=t("./sections/header"),o=t("./sections/editor"),s=t("./sections/promotion"),i=t("./sections/analytics"),n=function(){return new e.HeaderSectionView({el:$(".section.header")}),new o.EditorSectionView({el:$(".section.designer")}),new s.PromotionSectionView({el:$(".section.social")}),new i.AnalyticsSectionView({el:$(".section.stats")})},$(n)});
//# sourceMappingURL=/js/landingpage_flat.js.ad3bfa8c.map